parameters:
  - name: env
    type: string
  - name: subscriptions
    type: string
  - name: productCheckoutFolderName
    type: string
    default: 'product'
  - name: templatesCheckoutFolderName
    type: string
    default: 'templates'

steps:
  - checkout: self
    path: ${{ parameters.productCheckoutFolderName }}
  - checkout: ${{ parameters.templatesCheckoutFolderName }}
    path: ${{ parameters.templatesCheckoutFolderName }}
  - task: PowerShell@2
    displayName: Initialize Pipeline
    inputs:
      filePath: $(Pipeline.Workspace)/${{ parameters.templatesCheckoutFolderName }}/pipeline/scripts/initialize-pipeline.ps1
      arguments: -Subscriptions "${{ parameters.subscriptions }}"
        -Environment "${{ parameters.env }}"
        -ProductCheckoutFolderName "${{ parameters.productCheckoutFolderName }}"
        -TemplatesCheckoutFolderName "${{ parameters.templatesCheckoutFolderName }}"
      pwsh: true
